---
title: "Economic Mobility"
author: "didemch"
date: "`r Sys.Date()`"
output:
  pdf_document: default
  html_document: default
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(warning = FALSE, message = FALSE)
library(tidyverse)
library(glmnet)
library(kableExtra)
library(knitr)
mobility <- readRDS("/Users/yung-peiko/Desktop/mobility.RDS")
theme_set(theme_bw())
```

# Regularized methods

Conducting an analysis of the `mobility` data. I will be looking at economic mobility across generations in the contemporary USA. The data comes from a large study, based on tax records, which allowed researchers to link the income of adults to the income of their parents several decades previously. For privacy reasons, data is aggregate statistics about economic mobility for several hundred communities, containing most of the American population, and covariate information about those communities. I am interested in predicting economic mobility from the characteristics of communities. Note that some observations are missing values for some covariates.


1. The following code generates a map of `Mobility` ignoring Alaska and Hawaii.

```{r mobility-plot}
ggplot(
  mobility %>% filter(!(State %in% c("AK", "HI") )), 
  aes(x=Longitude, y=Latitude, color = Mobility)) + 
  geom_point() +
  coord_map() + 
  borders("state") +
  scale_color_viridis_c()
```


According to the map above, North Dakota has one of the highest mobility rates across the US. One community in North Dakota has the highest mobility rate across the whole US (mobiloty higher than 0.4). Other states in the rural Midwest (South Dakota, Nebraska, Kansas, Colorado, etc.) seem to also have a higher mobility rate compared with the states on both East and West coasts. The East Coast has a lot more observations than the West coast. Overall, states on the West Coast (California, Washington, Oregon, Nevada) and on the East Coast (New York, New Jersey, Connecticut, Pennsylvania) don't have as high mobility rates. This may be due to the fact that those states always had a higher standard of living, hence, their growth is not as significant as an increase in living conditions for those in the middle states of the US. The Southeast of the US seems to have the lowest mobility rate across the whole country.



2. Making scatter plots of mobility against each of the following variables: `Population`, `Income`, `Seg_racial`, `Share01`, `School_spending`, `Violent_crime`, and `Commute`. Including on each plot a line for the univariate regression of mobility on the variable, and giving a table of the slope coefficients. Then explaining the interpretation of each coefficient in the context of the problem. 

::: {.solbox data-latex=""}
```{r scatter-plots-base}
plot1 <- ggplot(mobility, aes(Population, Mobility)) +
  geom_point() +
  geom_smooth(method = lm, se = FALSE)
       
plot2 <- ggplot(mobility, aes(Income, Mobility)) +
  geom_point() +
  geom_smooth(method = lm, se = FALSE)

plot3 <- ggplot(mobility, aes(Seg_racial, Mobility)) +
  geom_point() +
  geom_smooth(method = lm, se = FALSE)

plot4 <- ggplot(mobility, aes(Share01, Mobility)) +
  geom_point() +
  geom_smooth(method = lm, se = FALSE)

plot5 <- ggplot(mobility, aes(School_spending, Mobility)) +
  geom_point() +
  geom_smooth(method = lm, se = FALSE)

plot6 <- ggplot(mobility, aes(Violent_crime, Mobility)) +
  geom_point() +
  geom_smooth(method = lm, se = FALSE)

plot7 <- ggplot(mobility, aes(Commute, Mobility)) +
  geom_point() +
  geom_smooth(method = lm, se = FALSE)
require(gridExtra)
grid.arrange(plot1, plot2,plot3, plot4, plot5, plot6, plot7, ncol=3, nrow=3)
```